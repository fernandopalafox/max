{
  "data_collection": {
    "num_episodes": 100,
    "max_episode_length": 100,
    "seed": 42,
    "save_path": "./data/pretraining_data",
    "wandb_project": "data_collection",
    "plot_freq": 10,

    "num_agents": 1,
    "dim_state": 4,
    "dim_action": 2,
    "state_labels": ["pos_x", "pos_y", "vel_x", "vel_y"],

    "env_name": "linear_tracking",
    "env_params": {
      "num_agents": 1,
      "box_half_width": 100.0,
      "max_episode_steps": 200,
      "dt": 0.1,
      "max_accel": 2.0,
      "true_A": [
        [1.0, 0.0, 0.1, 0.0],
        [0.0, 1.0, 0.0, 0.1],
        [0.0, 0.0, 0.95, 0.0],
        [0.0, 0.0, 0.0, 0.95]
      ],
      "true_B": [
        [0.005, 0.0],
        [0.0, 0.005],
        [0.1, 0.0],
        [0.0, 0.1]
      ],
      "target_point": [5.0, 5.0, 0.0, 0.0]
    },

    "dynamics": "linear",
    "dynamics_params": {
      "init_A": [
        [1.0, 0.0, 0.1, 0.0],
        [0.0, 1.0, 0.0, 0.1],
        [0.0, 0.0, 0.95, 0.0],
        [0.0, 0.0, 0.0, 0.95]
      ],
      "init_B": [
        [0.005, 0.0],
        [0.0, 0.005],
        [0.1, 0.0],
        [0.0, 0.1]
      ]
    },

    "trainer": "ekf",
    "trainer_params": {
      "learning_rate": 1.0,
      "weight_decay": 0.0,
      "proc_noise_init": 0.0,
      "proc_noise_decay": 1.0,
      "proc_noise_floor": 0.0,
      "init_cov_scale": 0.1,
      "jitter": 0.0
    },

    "planner_type": "icem",
    "planner_params": {
      "horizon": 15,
      "batch_size": 300,
      "max_iter": 5,
      "elit_frac": 0.1,
      "learning_rate": 0.9,
      "dim_control": 2,
      "action_low": [-2.0, -2.0],
      "action_high": [2.0, 2.0]
    },

    "cost_type": "linear_tracking_info",
    "cost_fn_params": {
      "weight_jerk": 0.01,
      "weight_control": 1.0,
      "weight_info": 0.0,
      "goal_state": [0.0, 5.0, 0.0, 0.0],
      "meas_noise_diag": [0.01, 0.01, 0.01, 0.01]
    },

    "normalization": { "method": "static" },
    "normalization_params": {
      "state": { "min": [-20.0, -20.0, -5.0, -5.0], "max": [20.0, 20.0, 5.0, 5.0] },
      "action": { "min": [-2.0, -2.0], "max": [2.0, 2.0] },
      "delta": { "min": [-2.0, -2.0, -0.5, -0.5], "max": [2.0, 2.0, 0.5, 0.5] }
    },

    "domain_randomization": {
      "goal_state": {
        "min": [-15.0, -15.0, 0.0, 0.0],
        "max": [15.0, 15.0, 0.0, 0.0]
      }
    }
  },

  "pretraining": {
    "seed": 42,
    "wandb_project": "pretraining",
    "data_path": "./data/pretraining_data/linear_tracking_buffer.pkl",
    "save_path": "./data/pretrained_models",

    "num_epochs": 100,
    "batch_size": 64,
    "train_split": 0.8,

    "dim_state": 4,
    "dim_action": 2,

    "dynamics": "mlp_resnet",
    "dynamics_params": {
      "nn_features": [32, 32],
      "ensemble_size": 1
    },

    "trainer": "gd",
    "trainer_params": {
      "learning_rate": 3e-4
    },

    "normalization": { "method": "static" },
    "normalization_params": {
      "state": { "min": [-20.0, -20.0, -5.0, -5.0], "max": [20.0, 20.0, 5.0, 5.0] },
      "action": { "min": [-2.0, -2.0], "max": [2.0, 2.0] },
      "delta": { "min": [-2.0, -2.0, -0.5, -0.5], "max": [2.0, 2.0, 0.5, 0.5] }
    }
  },

  "finetuning": {
    "wandb_project": "linear_with_nn",
    "seed": 43,
    "save_dir": "./trained_models",
    "plot_run": false,
    "plot_eval": false,
    "env_name": "linear_tracking",
    "num_agents": 1,
    "total_steps": 150,
    "dim_state": 4,
    "dim_action": 2,
    "train_model_freq": 1,
    "train_policy_freq": 1,
    "normalize_freq": 1000000,
    "eval_freq": 5,
    "buffer_size": 2000,

    "evaluator_type": "rollout",
    "evaluator_params": {
      "seed": 123,
      "max_steps": 100,
      "num_episodes": 1,
      "eval_cost_types": ["goal_cost", "terminal_goal_cost"],
      "env_params": {},
      "dynamics_params": {},
      "planner_params": {},
      "cost_fn_params": {
        "weight_jerk": 0.01,
        "weight_control": 1.0,
        "weight_info": 0.0,
        "goal_state": [-5.0, -5.0, 0.0, 0.0],
        "meas_noise_diag": [0.01, 0.01, 0.01, 0.01]
      }
    },

    "dynamics": "mlp_resnet",
    "dynamics_params": {
      "nn_features": [32, 32],
      "ensemble_size": 1,
      "svd_rank_input": null,
      "svd_rank_hidden": 32,
      "svd_rank_output": null,
      "steering_dim": 16,
      "r_init_std": 1e-5,
      "pretrained_params_path": "./data/pretrained_models/mlp_resnet_linear_tracking.pkl"
    },

    "env_params": {
      "num_agents": 1,
      "box_half_width": 100.0,
      "max_episode_steps": 2000,
      "dt": 0.1,
      "max_accel": 2.0,
      "true_A": [
        [1.0, 0.0, 0.1, 0.0],
        [0.0, 1.0, 0.0, 0.1],
        [0.0, 0.0, 0.95, 0.3],
        [0.0, 0.0, -0.3, 0.95]
      ],
      "true_B": [
        [0.007, 0.005],
        [-0.005, 0.007],
        [0.12, 0.08],
        [-0.08, 0.12]
      ],
      "target_point": [5.0, 5.0, 0.0, 0.0]
    },

    "trainer": "ekf",
    "trainer_params": {
      "learning_rate": 40.0,
      "weight_decay": 1.0,
      "proc_noise_init": 0.0,
      "proc_noise_decay": 1.0,
      "proc_noise_floor": 0.0,
      "init_cov_scale": 14.0,
      "jitter": 0.0
    },

    "normalization": {
      "method": "static"
    },
    "normalization_params": {
      "state": {
        "min": [-20.0, -20.0, -5.0, -5.0],
        "max": [20.0, 20.0, 5.0, 5.0]
      },
      "action": {
        "min": [-2.0, -2.0],
        "max": [2.0, 2.0]
      },
      "delta": {
        "min": [-2.0, -2.0, -0.5, -0.5],
        "max": [2.0, 2.0, 0.5, 0.5]
      }
    },

    "state_labels": ["pos_x", "pos_y", "vel_x", "vel_y"],

    "cost_type": "linear_tracking_info",
    "planner_type": "icem",
    "planner_params": {
      "horizon": 15,
      "batch_size": 300,
      "max_iter": 5,
      "elit_frac": 0.1,
      "learning_rate": 0.9,
      "dim_control": 2,
      "action_low": [-2.0, -2.0],
      "action_high": [2.0, 2.0]
    },

    "cost_fn_params": {
      "weight_jerk": 0.01,
      "weight_control": 1.0,
      "weight_info": 0.0,
      "goal_state": [0.0, 5.0, 0.0, 0.0],
      "meas_noise_diag": [0.01, 0.01, 0.01, 0.01]
    }
  }
}
